-- Simple version for Delta compatibility
local Players = game:GetService("Players")
local player = Players.LocalPlayer

-- Wait for player to load
repeat wait() until player
repeat wait() until player.Character
repeat wait() until player.Character:FindFirstChild("HumanoidRootPart")

print("Player loaded, creating GUI...")

-- Remove old GUI
if player.PlayerGui:FindFirstChild("KONTOL_TESTER") then
    player.PlayerGui:FindFirstChild("KONTOL_TESTER"):Destroy()
end

-- Create GUI
local gui = Instance.new("ScreenGui")
gui.Name = "KONTOL_TESTER"
gui.Parent = player.PlayerGui

-- Main Frame
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 300, 0, 120)
frame.Position = UDim2.new(0, 100, 0, 100)
frame.BackgroundColor3 = Color3.new(0.1, 0.1, 0.1)
frame.BorderSizePixel = 2
frame.BorderColor3 = Color3.new(1, 0, 1)
frame.Active = true
frame.Draggable = true
frame.Parent = gui

-- Title
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -40, 0, 30)
title.Position = UDim2.new(0, 5, 0, 5)
title.Text = "MEKI TELEPORTER"
title.TextColor3 = Color3.new(1, 1, 1)
title.BackgroundTransparency = 1
title.Font = Enum.Font.SourceSansBold
title.TextSize = 16
title.Parent = frame

-- Toggle Button
local toggleBtn = Instance.new("TextButton")
toggleBtn.Size = UDim2.new(0, 280, 0, 40)
toggleBtn.Position = UDim2.new(0, 10, 0, 40)
toggleBtn.Text = "START TELEPORT"
toggleBtn.TextColor3 = Color3.new(1, 1, 1)
toggleBtn.BackgroundColor3 = Color3.new(0.2, 0.5, 0.2)
toggleBtn.Font = Enum.Font.SourceSansBold
toggleBtn.TextSize = 18
toggleBtn.Parent = frame

-- Status Label
local status = Instance.new("TextLabel")
status.Size = UDim2.new(1, -20, 0, 30)
status.Position = UDim2.new(0, 10, 0, 85)
status.Text = "Status: OFF"
status.TextColor3 = Color3.new(1, 1, 0)
status.BackgroundTransparency = 1
status.Font = Enum.Font.SourceSans
status.TextSize = 14
status.Parent = frame

print("GUI created successfully!")

-- Variables
local isRunning = false
local currentPos = 1

-- Teleport coordinates
local positions = {
    {136, 143, -175},
    {326, 88, -433},
    {476, 169, -940},
    {930, 134, -626},
    {923, 101, 279},
    {266, 325, 711}
}

-- Get character function
local function getCharacter()
    return player.Character
end

-- Get HumanoidRootPart function
local function getHRP()
    local char = getCharacter()
    if char then
        return char:FindFirstChild("HumanoidRootPart")
    end
    return nil
end

-- Get Humanoid function
local function getHumanoid()
    local char = getCharacter()
    if char then
        return char:FindFirstChild("Humanoid")
    end
    return nil
end

-- Teleport function
local function teleportTo(pos)
    local hrp = getHRP()
    if hrp then
        hrp.CFrame = CFrame.new(pos[1], pos[2], pos[3])
        return true
    end
    return false
end

-- Kill player function
local function killPlayer()
    local humanoid = getHumanoid()
    if humanoid then
        humanoid.Health = 0
        return true
    end
    return false
end

-- Main teleport loop
local function startTeleportLoop()
    spawn(function()
        while isRunning do
            -- Add 4 second delay at the start of each cycle (after spawn/respawn)
            if currentPos == 1 then
                status.Text = "Status: Waiting 4s before Task 1..."
                print("Waiting 4 seconds before starting Task 1...")
                wait(4)
            end
            
            -- Update status
            status.Text = "Status: Running - Pos " .. currentPos .. "/6"
            
            -- Get current position
            local pos = positions[currentPos]
            
            -- Try to teleport
            if teleportTo(pos) then
                print("Teleported to position " .. currentPos .. ": " .. pos[1] .. ", " .. pos[2] .. ", " .. pos[3])
            else
                print("Failed to teleport - character not found")
                status.Text = "Status: Error - No Character"
                wait(2)
            end
            
            -- Wait between teleports
            wait(2)
            
            -- Move to next position
            currentPos = currentPos + 1
            
            -- Check if completed all positions
            if currentPos > #positions then
                if isRunning then
                    print("Cycle complete - killing player for respawn...")
                    status.Text = "Status: Respawning..."
                    
                    -- Kill player
                    killPlayer()
                    
                    -- Wait for respawn
                    local respawnStart = tick()
                    repeat 
                        wait(0.5)
                    until getCharacter() and getHRP() or (tick() - respawnStart > 10)
                    
                    wait(2) -- Extra wait for stability
                    currentPos = 1 -- Reset to first position
                    print("Respawned! Starting new cycle...")
                else
                    break
                end
            end
        end
        status.Text = "Status: OFF"
    end)
end

-- Toggle button click
toggleBtn.MouseButton1Click:Connect(function()
    isRunning = not isRunning
    
    if isRunning then
        toggleBtn.Text = "STOP TELEPORT"
        toggleBtn.BackgroundColor3 = Color3.new(0.8, 0.2, 0.2)
        currentPos = 1
        print("Teleport started!")
        startTeleportLoop()
    else
        toggleBtn.Text = "START TELEPORT"
        toggleBtn.BackgroundColor3 = Color3.new(0.2, 0.5, 0.2)
        status.Text = "Status: OFF"
        print("Teleport stopped!")
    end
end)

-- Character respawn handler
player.CharacterAdded:Connect(function()
    wait(2) -- Wait for character to fully load
    print("Character respawned and ready!")
end)

print("Script fully loaded and ready to use!")
